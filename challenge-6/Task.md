# ABC Passenger Segmentation

## Overview

The goal of this project is to segment airline passengers based on their contribution to the airline's total revenue. By categorizing passengers into three groups—A, B, and C—based on the cumulative share percentage of total income, airlines can optimize marketing strategies and loyalty programs to focus on high-value customers.

Frequent flyers contribute significantly to revenue, and this segmentation aims to identify and target these high-contributing passengers. Grouping passengers by their revenue share enables airlines to enhance their relationship with top customers and develop more effective loyalty programs.

## Objectives

### 1. Retrieve Passenger Information
- First, retrieve the `ID_psg` (Passenger ID) and `passenger_name` (Passenger Name) from the **Passenger** table.
  
### 2. Calculate Passenger Income
- Calculate the income generated by each passenger in dollars. The passenger income is based on the flight duration recorded in the **Pass_in_trip** and **Trip** tables, with the assumption that each second of flight contributes **one cent**.
  
- Calculate the `passenger_income_dollars` for each passenger.

### 3. Compute Cumulative Share Percentage
- After calculating the passenger income, determine the **cumulative share percentage** (`cumulative_share_percent`), which represents each passenger's share of the total income. 
- The passengers should be **sorted by their income levels**, and the cumulative share percentage shows the proportion of total revenue that comes from the combined income of these passengers.

### 4. Passenger Segmentation into Categories
- Use the **cumulative_share_percent** to segment passengers into three categories:
  - **Category A**: Represents passengers contributing up to **80%** of the cumulative income.
  - **Category B**: Represents passengers contributing between **80.01% and 95%** of the cumulative income.
  - **Category C**: Represents passengers contributing between **95.01% and 100%** of the cumulative income.

- The segmentation is based on the cumulative share percentage, with the percentages rounded to two decimal places.

### 5. SQL Query Requirements
- **JOIN Tables**: Use the `JOIN` function to combine the relevant data from the **Passenger**, **Pass_in_trip**, and **Trip** tables.
- **CTE (WITH Clause)**: Utilize Common Table Expressions (CTEs) to reuse subqueries efficiently.
- **CASE Statement**: Use the `CASE` function to classify passengers into the A, B, or C categories based on their cumulative share percentage.
- **GROUP BY**: Group the results by `ID_psg` and `passenger_name` to calculate the income for each passenger.

### 6. Output Requirements
- The final output should include the following columns:
  1. `ID_psg` (Passenger ID)
  2. `passenger_name` (Passenger Name)
  3. `passenger_income_dollars` (Income in dollars)
  4. `cumulative_share_percent` (Cumulative share percentage)
  5. `category` (Passenger category A, B, or C)


## Concepts Applied

  1. CTE (Common Table Expressions)
  2. JOINS
  3. Window functions
  4. Aggregations
 

